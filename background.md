In 1971 Denmark was divided into 2039 parishes, increasing to between 2116 and 2124 parishes from 1998 to 2010, between 2169 to 2194 parishes from 2011 to 2016, and 2159 parishes in 2018. The historic changes in parish boundaries challenges longitudinal geospatial analyses using parish as the neighborhood of interest. In addition, parishes also vary considerably in population size; for example, in 2005, the 2159 parishes had a mean of 2505 residents but a large variance (IQR: 484 to 3158; Range: 33 to 37,872 residents)

From 1st January 1971 to 28th June 2003 Denmark was also divided into 275 municipalities, a higher geographic aggregation. A municipality reform in Bornholm on 29th June 2003 collapsed the five municipalities in Bornholm into one municipality, reducing the number of municipalities to 271. Then a major national municipality reform on 1 January 2007 redistributed Denmark into 98 municipalities, although the island of Ærø implemented the national municipality reform on 1st January 2006. Due to the municipality reform 32 municipality borders were unchanged; 225 municipalities were collapsed into larger municipalities without changing borders; and 14 municipality borders were changed. In addition, Christiansø, a small island, located north-east of Bornholm with 92 residents is not included in any municipality boundaries.

Disregarding changes in borders, these geographic areas vary considerably in population size, which also leads to challenges in geospatial analyses. For example, the 98-level municipality division has a mean population size of 55,179 residents (IQR: 28,834 to 59,848 residents; Range: 2090 to 495,507 residents), the 270-level municipality division had a mean of 20,028 residents (IQR: 7162 to 19,099 residents; Range 2090 to 495,506 residents) [all values in 2005].

Faced with these challenges, we applied zone design algorithms on nationwide longitudinal residential geographic coordinates to divide Denmark into a total of 1885 homogeneously sized geographic areas, and to create a new level of geography, hereafter referred to as ‘data zones’. Unlike other zoning algorithms which emphasized finding demographically/socioeconomically homogenized regions, our data zone algorithm aims to define geographic areas that are homogenized in population density and size. This way, we can avoid the selection bias by creating zones not by natural aggregations of residences but the variables we intend to estimate, such as socio-economic status. The data zones were defined by a data driven / automatic tessellation algorithm that finds a fine balance between respecting the clustering of community and the agnostic assignment of the area without prior knowledge. The zoning algorithm has three stages: Stage I - clustering, Stage II - tessellations, and Stage III - zone refinement. Here we describe the details of each stage. First, given a point pattern as all residents living in a given municipality, a density-based clustering algorithm is performed to identify the natural clustering of residential areas. The constraint for defining a cluster is set as 2000 to 3000 people in each data zone. The map is divided into sub-areas, as captured by the clustering results, each of them would then feed into the tessellation step. In the second stage, adaptive binning of Voronoi tessellation was performed on each sub-area. The objective function is to break down the sub-areas into smaller zones so that the number of people in each zone is close to the target number (2500 individuals in this study). The third stage is then to refine every zone within the municipality, merging neighboring and splitting zones that failed to reach the target. The Zoning algorithm was implemented in R version 3.5.0.

Data zones were constrained to nest within the 98 municipalities in Denmark. We aimed for a mean data zone size of 2500 individuals. A minimum number of residents of 1200 was chosen to ensure confidentiality for all neighborhood-level counts; any numerator in any year in any data zone must exceed five. The procedure was applied to the annual mean number of residents at each address from 1980 to 2016. When we applied this homogenously population-sized geographic division to Denmark, the mean of annual number of residents per data zone was 2820 people (sd=809, range from 768 to 6495). Interest is also on the annual numbers, for example in 2005, the mean residents per data zone was 2869 people (sd=840, range from 793 to 7564).
